## API Report File for "@svta/cml-cmcd"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { ExclusiveRecord } from '@svta/cml-utils';
import { HttpRequest } from '@svta/cml-utils';
import { HttpResponse } from '@svta/cml-utils';
import { SfBareItem } from '@svta/cml-structured-field-values';
import { SfItem } from '@svta/cml-structured-field-values';
import { SfToken } from '@svta/cml-structured-field-values';
import { ValueOf } from '@svta/cml-utils';
import { ValueOrArray } from '@svta/cml-utils';

// @public
export function appendCmcdHeaders(headers: Record<string, string>, cmcd: Cmcd, options?: CmcdEncodeOptions): Record<string, string>;

// @public
export function appendCmcdQuery(url: string, cmcd: Cmcd, options?: CmcdEncodeOptions): string;

// @public
export type Cmcd = CmcdRequest & CmcdResponse & CmcdEvent;

// @public
export const CMCD_DEFAULT_TIME_INTERVAL = 30;

// @public
export const CMCD_EVENT_AD_BREAK_END: "abe";

// @public
export const CMCD_EVENT_AD_BREAK_START: "abs";

// @public
export const CMCD_EVENT_AD_END: "ae";

// @public
export const CMCD_EVENT_AD_START: "as";

// @public
export const CMCD_EVENT_BACKGROUNDED_MODE: "b";

// @public
export const CMCD_EVENT_BITRATE_CHANGE: "bc";

// @public
export const CMCD_EVENT_CONTENT_ID: "c";

// @public
export const CMCD_EVENT_CUSTOM_EVENT: "ce";

// @public
export const CMCD_EVENT_ERROR: "e";

// @public
export const CMCD_EVENT_KEYS: readonly ["cen", "e", "h", "ts"];

// @public
export const CMCD_EVENT_MODE: "event";

// @public
export const CMCD_EVENT_MUTE: "m";

// @public
export const CMCD_EVENT_PLAY_STATE: "ps";

// @public
export const CMCD_EVENT_PLAYER_COLLAPSE: "pc";

// @public
export const CMCD_EVENT_PLAYER_EXPAND: "pe";

// @public
export const CMCD_EVENT_RESPONSE_RECEIVED: "rr";

// @public
export const CMCD_EVENT_SKIP: "sk";

// @public
export const CMCD_EVENT_TIME_INTERVAL: "t";

// @public
export const CMCD_EVENT_UNMUTE: "um";

// @public
export const CMCD_FORMATTER_MAP: Record<string, CmcdFormatter>;

// @public
export const CMCD_HEADER_FIELDS: readonly CmcdHeaderField[];

// @public
export const CMCD_HEADER_MAP: Record<CmcdRequestKey | "nrr", CmcdHeaderField>;

// @public
export const CMCD_HEADERS: "headers";

// @public @deprecated
export const CMCD_JSON: "json";

// @public
export const CMCD_KEYS: CmcdKey[];

// @public
export const CMCD_OBJECT: "CMCD-Object";

// @public
export const CMCD_PARAM = "CMCD";

// @public
export const CMCD_QUERY: "query";

// @public
export const CMCD_REQUEST: "CMCD-Request";

// @public
export const CMCD_REQUEST_KEYS: readonly ["ab", "bg", "bl", "br", "bs", "bsa", "bsd", "bsda", "cdn", "cid", "cs", "d", "dfa", "dl", "ec", "lab", "lb", "ltc", "msd", "mtp", "nor", "nr", "ot", "pb", "pr", "pt", "rtp", "sf", "sid", "sn", "st", "sta", "su", "tab", "tb", "tbl", "tpb", "v"];

// @public
export const CMCD_REQUEST_MODE: "request";

// @public
export const CMCD_RESPONSE_KEYS: readonly ["cmsdd", "cmsds", "rc", "smrt", "ttfb", "ttfbb", "ttlb", "url"];

// @public
export const CMCD_SESSION: "CMCD-Session";

// @public
export const CMCD_STATUS: "CMCD-Status";

// @public
export const CMCD_V1: 1;

// @public
export const CMCD_V1_KEYS: readonly ["bl", "br", "bs", "cid", "d", "dl", "mtp", "nor", "nrr", "ot", "pr", "rtp", "sf", "sid", "st", "su", "tb", "v"];

// @public
export const CMCD_V2: 2;

// @public
export const CMCD_VALIDATION_SEVERITY_ERROR = "error";

// @public
export const CMCD_VALIDATION_SEVERITY_WARNING = "warning";

// @public
export type CmcdCustomKey = `${string}-${string}`;

// @public
export type CmcdCustomValue = string | SfItem<string> | (string | SfItem<string>)[] | number | SfItem<number> | (number | SfItem<number>)[] | boolean | SfItem<boolean> | (boolean | SfItem<boolean>)[] | symbol | SfItem<symbol> | (symbol | SfItem<symbol>)[] | SfToken | SfItem<SfToken> | (SfToken | SfItem<SfToken>)[];

// @public
export type CmcdEncodeOptions = {
    version?: number;
    reportingMode?: CmcdReportingMode;
    formatters?: Partial<CmcdFormatterMap>;
    customHeaderMap?: Partial<CmcdHeaderMap>;
    filter?: (key: CmcdKey) => boolean;
    baseUrl?: string;
    events?: string[];
};

// @public
export type CmcdEvent = CmcdRequest & {
    cen?: string;
    e?: CmcdEventType;
    h?: string;
    ts?: number;
};

// @public
export type CmcdEventReportConfig = CmcdReportConfig & {
    version?: typeof CMCD_V2;
    url: string;
    events?: CmcdEventType[];
    interval?: number;
    batchSize?: number;
};

// @public
export const CmcdEventType: {
    readonly BITRATE_CHANGE: typeof CMCD_EVENT_BITRATE_CHANGE;
    readonly PLAY_STATE: typeof CMCD_EVENT_PLAY_STATE;
    readonly ERROR: typeof CMCD_EVENT_ERROR;
    readonly TIME_INTERVAL: typeof CMCD_EVENT_TIME_INTERVAL;
    readonly CONTENT_ID: typeof CMCD_EVENT_CONTENT_ID;
    readonly BACKGROUNDED_MODE: typeof CMCD_EVENT_BACKGROUNDED_MODE;
    readonly MUTE: typeof CMCD_EVENT_MUTE;
    readonly UNMUTE: typeof CMCD_EVENT_UNMUTE;
    readonly PLAYER_EXPAND: typeof CMCD_EVENT_PLAYER_EXPAND;
    readonly PLAYER_COLLAPSE: typeof CMCD_EVENT_PLAYER_COLLAPSE;
    readonly RESPONSE_RECEIVED: typeof CMCD_EVENT_RESPONSE_RECEIVED;
    readonly AD_START: typeof CMCD_EVENT_AD_START;
    readonly AD_END: typeof CMCD_EVENT_AD_END;
    readonly AD_BREAK_START: typeof CMCD_EVENT_AD_BREAK_START;
    readonly AD_BREAK_END: typeof CMCD_EVENT_AD_BREAK_END;
    readonly SKIP: typeof CMCD_EVENT_SKIP;
    readonly CUSTOM_EVENT: typeof CMCD_EVENT_CUSTOM_EVENT;
};

// @public (undocumented)
export type CmcdEventType = ValueOf<typeof CmcdEventType>;

// @public
export type CmcdFormatter = (value: CmcdValue, options: CmcdFormatterOptions) => ValueOrArray<number | SfItem<number>> | ValueOrArray<string | SfItem<string>>;

// @public
export type CmcdFormatterMap = Record<CmcdKey, CmcdFormatter>;

// @public
export type CmcdFormatterOptions = {
    version: number;
    reportingMode: CmcdReportingMode;
    baseUrl?: string;
};

// @public
export const CmcdHeaderField: {
    readonly OBJECT: typeof CMCD_OBJECT;
    readonly REQUEST: typeof CMCD_REQUEST;
    readonly SESSION: typeof CMCD_SESSION;
    readonly STATUS: typeof CMCD_STATUS;
};

// @public (undocumented)
export type CmcdHeaderField = ValueOf<typeof CmcdHeaderField>;

// @public
export type CmcdHeaderKey = keyof typeof CMCD_HEADER_MAP;

// @public
export type CmcdHeaderMap = Record<CmcdHeaderField, CmcdKey[]>;

// @public
export type CmcdHeaderValue = CmcdRequest | CmcdV1;

// @public
export type CmcdKey = keyof Cmcd | keyof CmcdV1;

// @public
export const CmcdObjectType: {
    readonly MANIFEST: "m";
    readonly AUDIO: "a";
    readonly VIDEO: "v";
    readonly MUXED: "av";
    readonly INIT: "i";
    readonly CAPTION: "c";
    readonly TIMED_TEXT: "tt";
    readonly KEY: "k";
    readonly OTHER: "o";
};

// @public (undocumented)
export type CmcdObjectType = ValueOf<typeof CmcdObjectType>;

// @public
export type CmcdObjectTypeList = (number | SfItem<number, ExclusiveRecord<CmcdObjectType, boolean>>)[];

// @public
export const CmcdPlayerState: {
    readonly STARTING: "s";
    readonly PLAYING: "p";
    readonly SEEKING: "k";
    readonly REBUFFERING: "r";
    readonly PAUSED: "a";
    readonly WAITING: "w";
    readonly ENDED: "e";
    readonly FATAL_ERROR: "f";
    readonly QUIT: "q";
    readonly PRELOADING: "d";
};

// @public (undocumented)
export type CmcdPlayerState = ValueOf<typeof CmcdPlayerState>;

// @public
export type CmcdReportConfig = {
    version?: CmcdVersion;
    enabledKeys?: CmcdKey[];
};

// @public
export class CmcdReporter {
    constructor(config: Partial<CmcdReporterConfig>, requester?: (request: HttpRequest) => Promise<{
        status: number;
    }>);
    // @deprecated
    applyRequestReport(req: HttpRequest): HttpRequest;
    createRequestReport<R extends HttpRequest = HttpRequest>(request: R, data?: Partial<Cmcd>): R & CmcdRequestReport<R["customData"]>;
    flush(): void;
    isRequestReportingEnabled(): boolean;
    recordEvent(type: CmcdEventType, data?: Partial<Cmcd>): void;
    recordResponseReceived(response: HttpResponse<HttpRequest<{
        cmcd?: Cmcd;
    }>>, data?: Partial<Cmcd>): void;
    start(): void;
    stop(flush?: boolean): void;
    update(data: Partial<Cmcd>): void;
}

// @public
export type CmcdReporterConfig = CmcdRequestReportConfig & {
    sid?: string;
    cid?: string;
    eventTargets?: CmcdEventReportConfig[];
};

// @public
export const CmcdReportingMode: {
    readonly REQUEST: typeof CMCD_REQUEST_MODE;
    readonly EVENT: typeof CMCD_EVENT_MODE;
};

// @public (undocumented)
export type CmcdReportingMode = ValueOf<typeof CmcdReportingMode>;

// @public
export type CmcdRequest = {
    [index: CmcdCustomKey]: CmcdCustomValue | undefined;
    ab?: CmcdObjectTypeList;
    bg?: boolean;
    bl?: CmcdObjectTypeList;
    br?: CmcdObjectTypeList;
    bs?: boolean;
    bsa?: CmcdObjectTypeList;
    bsd?: CmcdObjectTypeList;
    bsda?: CmcdObjectTypeList;
    cdn?: string;
    cid?: string;
    cs?: string;
    d?: number;
    dfa?: number;
    dl?: number;
    ec?: string[];
    lab?: CmcdObjectTypeList;
    lb?: CmcdObjectTypeList;
    ltc?: number;
    msd?: number;
    mtp?: CmcdObjectTypeList;
    nor?: (string | SfItem<string, {
        r: string;
    }>)[];
    nr?: boolean;
    ot?: CmcdObjectType;
    pb?: CmcdObjectTypeList;
    pr?: number;
    pt?: number;
    rtp?: number;
    sf?: CmcdStreamingFormat;
    sid?: string;
    sn?: number;
    st?: CmcdStreamType;
    sta?: CmcdPlayerState;
    su?: boolean;
    tab?: CmcdObjectTypeList;
    tb?: CmcdObjectTypeList;
    tbl?: CmcdObjectTypeList;
    tpb?: CmcdObjectTypeList;
    v?: number;
};

// @public
export type CmcdRequestKey = keyof CmcdRequest | "nrr";

// @public
export type CmcdRequestReport<D = unknown> = HttpRequest & {
    customData: {
        cmcd: Cmcd;
    } & D;
    headers: Record<string, string>;
};

// @public
export type CmcdRequestReportConfig = CmcdReportConfig & {
    transmissionMode?: CmcdTransmissionMode;
};

// @public
export type CmcdResponse = CmcdRequest & {
    cmsdd?: string;
    cmsds?: string;
    rc?: number;
    smrt?: string;
    ttfb?: number;
    ttfbb?: number;
    ttlb?: number;
    url?: string;
};

// @public
export const CmcdStreamingFormat: {
    readonly DASH: "d";
    readonly HLS: "h";
    readonly SMOOTH: "s";
    readonly OTHER: "o";
};

// @public (undocumented)
export type CmcdStreamingFormat = ValueOf<typeof CmcdStreamingFormat>;

// @public
export const CmcdStreamType: {
    readonly VOD: "v";
    readonly LIVE: "l";
    readonly LOW_LATENCY: "ll";
};

// @public (undocumented)
export type CmcdStreamType = ValueOf<typeof CmcdStreamType>;

// @public
export const CmcdTransmissionMode: {
    readonly JSON: typeof CMCD_JSON;
    readonly QUERY: typeof CMCD_QUERY;
    readonly HEADERS: typeof CMCD_HEADERS;
};

// @public (undocumented)
export type CmcdTransmissionMode = ValueOf<typeof CmcdTransmissionMode>;

// @public
export type CmcdV1 = {
    bl?: number;
    br?: number;
    mtp?: number;
    nor?: string;
    nrr?: string;
    tb?: number;
};

// @public
export type CmcdValidationIssue = {
    key?: string;
    message: string;
    severity: CmcdValidationSeverity;
};

// @public
export type CmcdValidationOptions = {
    version?: CmcdVersion;
    reportingMode?: CmcdReportingMode;
};

// @public
export type CmcdValidationResult = {
    valid: boolean;
    issues: CmcdValidationIssue[];
};

// @public
export const CmcdValidationSeverity: {
    readonly ERROR: typeof CMCD_VALIDATION_SEVERITY_ERROR;
    readonly WARNING: typeof CMCD_VALIDATION_SEVERITY_WARNING;
};

// @public
export type CmcdValidationSeverity = ValueOf<typeof CmcdValidationSeverity>;

// @public
export type CmcdValue = ValueOf<Cmcd>;

// @public
export type CmcdVersion = typeof CMCD_V1 | typeof CMCD_V2;

// @public
export function decodeCmcd<T extends Cmcd = Cmcd>(cmcd: string): T;

// @public
export function encodeCmcd(cmcd: Cmcd, options?: CmcdEncodeOptions): string;

// @public
export function fromCmcdHeaders(headers: Record<string, string> | Headers): Cmcd;

// @public
export function fromCmcdQuery(query: string | URLSearchParams): Cmcd;

// @public
export function fromCmcdUrl(url: string): Cmcd;

// @public
export function groupCmcdHeaders(cmcd: Cmcd, customHeaderMap?: Partial<CmcdHeaderMap>): Record<CmcdHeaderField, CmcdHeaderValue>;

// @public
export function isCmcdCustomKey(key: CmcdKey): boolean;

// @public
export function isCmcdEventKey(key: string): key is keyof Cmcd;

// @public
export function isCmcdRequestKey(key: string): key is keyof Cmcd;

// @public
export function isCmcdResponseReceivedKey(key: string): key is keyof Cmcd;

// @public
export function isCmcdV1Key(key: string): key is CmcdKey;

// @public
export function prepareCmcdData(obj: Record<string, any>, options?: CmcdEncodeOptions): Cmcd;

// @public
export function toCmcdHeaders(cmcd: Cmcd, options?: CmcdEncodeOptions): Record<CmcdHeaderField, string>;

// @public
export function toCmcdQuery(cmcd: Cmcd, options?: CmcdEncodeOptions): string;

// @public
export function toCmcdUrl(cmcd: Cmcd, options?: CmcdEncodeOptions): string;

// @public
export function toCmcdValue<V extends SfBareItem, P>(value: V, params?: P): SfItem<V, P>;

// @public
export function validateCmcd(data: Record<string, unknown>, options?: CmcdValidationOptions): CmcdValidationResult;

// @public
export function validateCmcdEvent(cmcd: string, options?: Omit<CmcdValidationOptions, "reportingMode">): CmcdValidationResult;

// @public
export function validateCmcdHeaders(headers: Partial<Record<CmcdHeaderField, string>>, options?: Omit<CmcdValidationOptions, "reportingMode">): CmcdValidationResult;

// @public
export function validateCmcdKeys(data: Record<string, unknown>, options?: CmcdValidationOptions): CmcdValidationResult;

// @public
export function validateCmcdRequest(request: Request | HttpRequest, options?: Omit<CmcdValidationOptions, "reportingMode">): CmcdValidationResult;

// @public
export function validateCmcdStructure(data: Record<string, unknown>, options?: CmcdValidationOptions): CmcdValidationResult;

// @public
export function validateCmcdValues(data: Record<string, unknown>, options?: CmcdValidationOptions): CmcdValidationResult;

// (No @packageDocumentation comment for this package)

```
